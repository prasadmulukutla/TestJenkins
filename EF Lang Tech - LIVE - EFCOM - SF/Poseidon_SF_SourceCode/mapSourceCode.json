{"Description":"","Valid":true,"Id":2396146,"LastModificationDate":"2018-09-26T07:30:36.967","LastRunDate":null,"MapType":"IntegrationServicesAdvancedMap","Name":"mapSourceCode","NetChange":false,"NetChangeFieldName":"","ProcessDefinitionDbId":"5ecc54fb-bb25-44e2-9256-8e7907df2a63","SourceConnectionId":"cb5f85fb-ed5a-4c4f-bac6-c1b11164e141","SourceConnectionName":"SFIntegration","SourceConnectionAlias":"SFIntegration","StartingBlockId":"469b9117-b102-4fe2-b784-57eff1a7e291","SourceConnectionType":"Microsoft SQL Server","TargetConnections":[{"ConnectionAlias":"Salesforce","ConnectionId":"f579fd74-94e5-4bb4-b592-d53cd3830c01","ConnectionName":"Salesforce","ConnectionType":"Salesforce"}],"Version":"2.2","Blocks":[{"id":"469b9117-b102-4fe2-b784-57eff1a7e291","blockType":"NativeQuery","category":"Source","name":"NativeQuery","description":"","label":"Native Query","originalBlockLabel":"Native Query","nextBlockId":"ee966d1e-6321-40af-aaa8-a9f7dbb1924e","parentBlockId":"","prevBlockId":"","x":216,"y":49,"entity":"NativeQuery","actionName":"Native Query","connectionId":"cb5f85fb-ed5a-4c4f-bac6-c1b11164e141","hasBeenTested":true,"queryText":"select * from (\nselect * , ROW_NUMBER()over(partition by efsourcecodename,MarketCode order by isnull(IsStandardSourceCode,0) desc, SourceCodeStatusCode) as [RowNumber] \nfrom (select * from PoseidonIICommon..SourceCode(nolock) where (IsStandardSourceCode=1 and MarketCode='FRP') OR ISNULL(IsStandardSourceCode,0)=0) t\nwhere \nProductCode not in ('HSY','IA')\nAND SourceCodeTableCode = 0\n)t\nwhere TS > ISNULL((select SourceCodeTS from sfintegration..SourceCode_ScribeTracking where IsScribeProcessed = 1),0)\nand t.RowNumber=1","statusOfMetadata":"Metadata successfully retrieved for Native query."},{"id":"ee966d1e-6321-40af-aaa8-a9f7dbb1924e","blockType":"ForEach","category":"Control","name":"ForEach","description":"","label":"For Each Result","originalBlockLabel":"For Each Result","nextBlockId":"","parentBlockId":"","prevBlockId":"469b9117-b102-4fe2-b784-57eff1a7e291","firstChildBlockId":"e2c08e57-5e33-4f77-851d-5e4c4a5b0bf5"},{"id":"e2c08e57-5e33-4f77-851d-5e4c4a5b0bf5","blockType":"IfElse","category":"Control","name":"IfElse","description":"","label":"Update max TS processed","originalBlockLabel":"If","nextBlockId":"3cb1f075-7ae8-4856-9709-0202975d67c1","parentBlockId":"ee966d1e-6321-40af-aaa8-a9f7dbb1924e","prevBlockId":"","firstChildBlockContainer1Id":"088174d8-a6dc-498b-87f0-7018449df11a","firstChildBlockContainer2Id":"","elseLabel":"else","expressionItems":[{"conditionOperator":0,"leftExpression":"RECNUM()","logicalOperator":0,"rightExpression":"1","id":"0a89a872-5bed-4c1a-89ba-53af312768ae"}]},{"id":"088174d8-a6dc-498b-87f0-7018449df11a","blockType":"UpdateInsert","category":"Source","name":"SourceCode_ScribeTrackingUpdateInsert","description":"","label":"Update/Insert SourceCode_ScribeTracking","originalBlockLabel":"Update/Insert","nextBlockId":"","parentBlockId":"e2c08e57-5e33-4f77-851d-5e4c4a5b0bf5","prevBlockId":"","containerIndex":0,"entity":"SourceCode_ScribeTracking","actionName":"Update","connectionId":"cb5f85fb-ed5a-4c4f-bac6-c1b11164e141","isOnNoMatchMessage":false,"isOnErrorMessage":true,"onErrorMessage":"Operation failed.  Label: [BLOCK LABEL], Name: [BLOCK NAME], Message: [ORIGINAL MESSAGE]","insertActionName":"Create","filterItems":[{"compareValue":"true","comparisonOperator":0,"fieldName":"IsScribeProcessed","logicalOperator":0,"id":"27dc9da5-fe05-4203-a6ff-ce811d126864"}],"fieldMappings":[{"id":"1a5066f7-fed3-494e-a15a-02f11dc1e559","targetDataType":"System.Int32","targetField":"SourceCodeId","targetFormula":"NativeQuery.sourcecode_id","path":"SourceCode_ScribeTracking"},{"id":"a8a6cdd3-dbe3-4f3a-ad2c-0df61b7880d2","targetDataType":"System.Byte[]","targetField":"SourceCodeTS","targetFormula":"NativeQuery.TS","path":"SourceCode_ScribeTracking"},{"id":"6a839092-5f5a-4921-ae53-fd132e402d32","targetDataType":"System.DateTime","targetField":"ScribeUTCDate","targetFormula":"GETUTCDATETIME()","path":"SourceCode_ScribeTracking"},{"id":"71cc3d9a-a45f-4a3d-99d6-c880e32c49ac","targetDataType":"System.Boolean","targetField":"IsScribeProcessed","targetFormula":"true","path":"SourceCode_ScribeTracking"}]},{"id":"3cb1f075-7ae8-4856-9709-0202975d67c1","blockType":"UpdateInsert","category":"Target","name":"Source__cUpdateInsert","description":"","label":"Update/Insert Source__c","originalBlockLabel":"Update/Insert","nextBlockId":"","parentBlockId":"ee966d1e-6321-40af-aaa8-a9f7dbb1924e","prevBlockId":"e2c08e57-5e33-4f77-851d-5e4c4a5b0bf5","entity":"Source__c","actionName":"Update","connectionId":"f579fd74-94e5-4bb4-b592-d53cd3830c01","isOnNoMatchMessage":false,"isOnErrorMessage":true,"onErrorMessage":"Operation failed.  Label: [BLOCK LABEL], Name: [BLOCK NAME], Message: [ORIGINAL MESSAGE]","insertActionName":"Create","filterItems":[{"compareValue":"IF(NativeQuery.IsStandardSourceCode=true,CONCATENATE(\"ALL-\",NativeQuery.EFSourceCodeName),CONCATENATE(NativeQuery.MarketCode,\"-\",NativeQuery.EFSourceCodeName))","comparisonOperator":0,"fieldName":"SourceUniqueKey__c","logicalOperator":0,"id":"fd81f31b-409a-40b2-8483-985f47a273fb"}],"fieldMappings":[{"id":"4b311ae4-682c-4f7b-96f1-0a01881642c9","targetDataType":"System.String","targetField":"Market__c","targetFormula":"IF(NativeQuery.IsStandardSourceCode=true,\"ALL\",NativeQuery.MarketCode)","path":"Source__c"},{"id":"03662359-68e1-445f-b870-db6d77d365bc","targetDataType":"System.String","targetField":"Code__c","targetFormula":"NativeQuery.EFSourceCodeName","path":"Source__c"},{"id":"6ba69d04-7259-4c99-9805-9462e1a89ff6","targetDataType":"System.Boolean","targetField":"IsGlobal__c","targetFormula":"IFNULLUSE(NativeQuery.IsStandardSourceCode,false)","path":"Source__c"},{"id":"03fb3ec5-d337-4e51-95d9-68f03c489818","targetDataType":"System.Boolean","targetField":"AvailableforManualEntry__c","targetFormula":"NativeQuery.ManualEntrySourceCode","path":"Source__c"},{"id":"40a3435a-46dd-4ce0-bfb5-339e7422ff97","targetDataType":"System.Boolean","targetField":"AvailableforExcelImport__c","targetFormula":"true","path":"Source__c"},{"id":"1e9b13e6-05a1-40d3-91ed-020ddbda8c26","targetDataType":"System.Boolean","targetField":"IsActive__c","targetFormula":"IF(NativeQuery.SourceCodeStatusCode=\"AC\",true,false)","path":"Source__c"},{"id":"7016c7c6-b1b7-4b83-9615-d9a8bde28632","targetDataType":"System.String","targetField":"Name","targetFormula":"NativeQuery.SourceCodeDetailName","path":"Source__c"}]}],"Revision":6,"RevisionDate":"2018-09-25T12:47:14.877","RevisionComment":null}