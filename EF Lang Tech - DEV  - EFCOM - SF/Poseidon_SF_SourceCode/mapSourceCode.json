{"Description":"","Valid":false,"Id":2320778,"LastModificationDate":"2018-10-09T12:19:55.923","LastRunDate":null,"MapType":"IntegrationServicesAdvancedMap","Name":"mapSourceCode","NetChange":false,"NetChangeFieldName":"","ProcessDefinitionDbId":"b72311cd-d011-4dfe-a438-ebac2c5d5891","SourceConnectionId":"bd24590d-4de3-4dc5-b564-12719dbde5e1","SourceConnectionName":"SFIntegration","SourceConnectionAlias":"SFIntegration","StartingBlockId":"c6257c26-f4b8-497b-bc4e-8901c13b8046","SourceConnectionType":"Microsoft SQL Server","TargetConnections":[{"ConnectionAlias":"Salesforce","ConnectionId":"010be794-527c-4f44-a1e1-83ab99542b18","ConnectionName":"Salesforce","ConnectionType":"Salesforce"}],"Version":"2.2","Blocks":[{"id":"c6257c26-f4b8-497b-bc4e-8901c13b8046","blockType":"NativeQuery","category":"Source","name":"NativeQuery","description":"","label":"Native Query","originalBlockLabel":"Native Query","nextBlockId":"ee966d1e-6321-40af-aaa8-a9f7dbb1924e","parentBlockId":"","prevBlockId":"","x":216,"y":49,"entity":"NativeQuery","actionName":"Native Query","connectionId":"bd24590d-4de3-4dc5-b564-12719dbde5e1","hasBeenTested":true,"queryText":"select * from (\nselect *,ROW_NUMBER()over(partition by efsourcecodename,MarketCode order by isnull(IsStandardSourceCode,0) desc, SourceCodeStatusCode) as [RowNumber] from PoseidonIICommon..SourceCode\nwhere MarketCode = 'NOO' AND ProductCode not in ('HSY','IA')\nAND SourceCode.SourceCodeTableCode = 0\n)t\nwhere t.RowNumber=1","statusOfMetadata":"Metadata successfully retrieved for Native query."},{"id":"ee966d1e-6321-40af-aaa8-a9f7dbb1924e","blockType":"ForEach","category":"Control","name":"ForEach","description":"","label":"For Each Result","originalBlockLabel":"For Each Result","nextBlockId":"","parentBlockId":"","prevBlockId":"c6257c26-f4b8-497b-bc4e-8901c13b8046","firstChildBlockId":"3cb1f075-7ae8-4856-9709-0202975d67c1"},{"id":"3cb1f075-7ae8-4856-9709-0202975d67c1","blockType":"UpdateInsert","category":"Target","name":"Source__cUpdateInsert","description":"","label":"Update/Insert Source__c","originalBlockLabel":"Update/Insert","nextBlockId":"","parentBlockId":"ee966d1e-6321-40af-aaa8-a9f7dbb1924e","prevBlockId":"","entity":"Source__c","actionName":"Update","connectionId":"010be794-527c-4f44-a1e1-83ab99542b18","isOnNoMatchMessage":false,"isOnErrorMessage":true,"onErrorMessage":"Operation failed.  Label: [BLOCK LABEL], Name: [BLOCK NAME], Message: [ORIGINAL MESSAGE]","insertActionName":"Create","filterItems":[{"compareValue":"IF(NativeQuery.IsStandardSourceCode=true,CONCATENATE(\"ALL-\",NativeQuery.EFSourceCodeName),CONCATENATE(NativeQuery.MarketCode,\"-\",NativeQuery.EFSourceCodeName))","comparisonOperator":0,"fieldName":"SourceUniqueKey__c","logicalOperator":0,"id":"449ce024-f3ce-4abb-87ff-891724d3a40f"}],"fieldMappings":[{"id":"d91af925-5d23-4bed-af86-6898ec198daa","targetDataType":"System.String","targetField":"Market__c","targetFormula":"IF(NativeQuery.IsStandardSourceCode=true,\"ALL\",NativeQuery.MarketCode)","path":"Source__c"},{"id":"5881bed0-b234-4e49-af61-072a79a023ae","targetDataType":"System.String","targetField":"Code__c","targetFormula":"NativeQuery.EFSourceCodeName","path":"Source__c"},{"id":"fe4f83a2-82b2-4a14-999c-18b973ed12ef","targetDataType":"System.Boolean","targetField":"IsGlobal__c","targetFormula":"IFNULLUSE(NativeQuery.IsStandardSourceCode,false)","path":"Source__c"},{"id":"b8a1ce79-eed3-4b71-b12e-ddf01deb83bd","targetDataType":"System.Boolean","targetField":"AvailableforManualEntry__c","targetFormula":"NativeQuery.ManualEntrySourceCode","path":"Source__c"},{"id":"168d2186-372b-42e7-9e82-0203e1b746e4","targetDataType":"System.Boolean","targetField":"AvailableforExcelImport__c","targetFormula":"true","path":"Source__c"},{"id":"936ab7b1-31f5-43c0-a087-293aaaecf7aa","targetDataType":"System.Boolean","targetField":"IsActive__c","targetFormula":"IF(NativeQuery.SourceCodeStatusCode=\"AC\",true,false)","path":"Source__c"},{"id":"f891d56c-e570-4706-81c2-bc1772753cea","targetDataType":"System.String","targetField":"Name","targetFormula":"NativeQuery.SourceCodeDetailName","path":"Source__c"}]},{"id":"e2c08e57-5e33-4f77-851d-5e4c4a5b0bf5","blockType":"IfElse","category":"Control","name":"IfElse","description":"","label":"Update max TS processed","originalBlockLabel":"If","nextBlockId":"","parentBlockId":"","prevBlockId":"","x":597,"y":100,"firstChildBlockContainer1Id":"088174d8-a6dc-498b-87f0-7018449df11a","firstChildBlockContainer2Id":"","elseLabel":"else","expressionItems":[{"conditionOperator":0,"leftExpression":"RECNUM()","logicalOperator":0,"rightExpression":"1","id":"b4ddee0b-e679-42eb-8f0b-f758db864f60"}]},{"id":"088174d8-a6dc-498b-87f0-7018449df11a","blockType":"UpdateInsert","category":"Source","name":"SourceCode_ScribeTrackingUpdateInsert","description":"","label":"Update/Insert SourceCode_ScribeTracking","originalBlockLabel":"Update/Insert","nextBlockId":"","parentBlockId":"e2c08e57-5e33-4f77-851d-5e4c4a5b0bf5","prevBlockId":"","containerIndex":0,"entity":"SourceCode_ScribeTracking","actionName":"Update","connectionId":"bd24590d-4de3-4dc5-b564-12719dbde5e1","isOnNoMatchMessage":false,"isOnErrorMessage":true,"onErrorMessage":"Operation failed.  Label: [BLOCK LABEL], Name: [BLOCK NAME], Message: [ORIGINAL MESSAGE]","insertActionName":"Create","filterItems":[{"compareValue":"true","comparisonOperator":0,"fieldName":"IsScribeProcessed","logicalOperator":0,"id":"b50020fd-74f8-4d21-93d0-f37a664bdf97"}],"fieldMappings":[{"id":"e5e8b6fe-1219-44fa-bf18-1566aaea65b7","targetDataType":"System.Int32","targetField":"SourceCodeId","targetFormula":"NativeQuery.sourcecode_id","path":"SourceCode_ScribeTracking"},{"id":"550d4463-4138-4444-be4d-a31fd886992d","targetDataType":"System.Byte[]","targetField":"SourceCodeTS","targetFormula":"NativeQuery.TS","path":"SourceCode_ScribeTracking"},{"id":"fdd554f6-79ca-4ad3-943a-456e3a4607af","targetDataType":"System.DateTime","targetField":"ScribeUTCDate","targetFormula":"GETUTCDATETIME()","path":"SourceCode_ScribeTracking"},{"id":"22571004-df93-4dc3-b99b-5f444a403b0c","targetDataType":"System.Boolean","targetField":"IsScribeProcessed","targetFormula":"true","path":"SourceCode_ScribeTracking"}]}],"Revision":9,"RevisionDate":"2018-06-14T08:43:18.853","RevisionComment":null}