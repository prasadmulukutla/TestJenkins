{"Description":"","Valid":false,"Id":2321737,"LastModificationDate":"2018-10-09T12:19:55.923","LastRunDate":null,"MapType":"IntegrationServicesAdvancedMap","Name":"mapSourceCode","NetChange":false,"NetChangeFieldName":"","ProcessDefinitionDbId":"b72311cd-d011-4dfe-a438-ebac2c5d5891","SourceConnectionId":"bd24590d-4de3-4dc5-b564-12719dbde5e1","SourceConnectionName":"SFIntegration","SourceConnectionAlias":"SFIntegration","StartingBlockId":"c6257c26-f4b8-497b-bc4e-8901c13b8046","SourceConnectionType":"Microsoft SQL Server","TargetConnections":[{"ConnectionAlias":"Salesforce","ConnectionId":"010be794-527c-4f44-a1e1-83ab99542b18","ConnectionName":"Salesforce","ConnectionType":"Salesforce"}],"Version":"2.2","Blocks":[{"id":"c6257c26-f4b8-497b-bc4e-8901c13b8046","blockType":"NativeQuery","category":"Source","name":"NativeQuery","description":"","label":"Native Query","originalBlockLabel":"Native Query","nextBlockId":"ee966d1e-6321-40af-aaa8-a9f7dbb1924e","parentBlockId":"","prevBlockId":"","x":216,"y":49,"entity":"NativeQuery","actionName":"Native Query","connectionId":"bd24590d-4de3-4dc5-b564-12719dbde5e1","hasBeenTested":true,"queryText":"select * from (\nselect *,ROW_NUMBER()over(partition by efsourcecodename,MarketCode order by isnull(IsStandardSourceCode,0) desc, SourceCodeStatusCode) as [RowNumber] from PoseidonIICommon..SourceCode\nwhere MarketCode = 'NOO' AND ProductCode not in ('HSY','IA')\nAND SourceCode.SourceCodeTableCode = 0\n)t\nwhere t.RowNumber=1","statusOfMetadata":"Metadata successfully retrieved for Native query."},{"id":"ee966d1e-6321-40af-aaa8-a9f7dbb1924e","blockType":"ForEach","category":"Control","name":"ForEach","description":"","label":"For Each Result","originalBlockLabel":"For Each Result","nextBlockId":"","parentBlockId":"","prevBlockId":"c6257c26-f4b8-497b-bc4e-8901c13b8046","firstChildBlockId":"3cb1f075-7ae8-4856-9709-0202975d67c1"},{"id":"3cb1f075-7ae8-4856-9709-0202975d67c1","blockType":"UpdateInsert","category":"Target","name":"Source__cUpdateInsert","description":"","label":"Update/Insert Source__c","originalBlockLabel":"Update/Insert","nextBlockId":"","parentBlockId":"ee966d1e-6321-40af-aaa8-a9f7dbb1924e","prevBlockId":"","entity":"Source__c","actionName":"Update","connectionId":"010be794-527c-4f44-a1e1-83ab99542b18","isOnNoMatchMessage":false,"isOnErrorMessage":true,"onErrorMessage":"Operation failed.  Label: [BLOCK LABEL], Name: [BLOCK NAME], Message: [ORIGINAL MESSAGE]","insertActionName":"Create","filterItems":[{"compareValue":"IF(NativeQuery.IsStandardSourceCode=true,CONCATENATE(\"ALL-\",NativeQuery.EFSourceCodeName),CONCATENATE(NativeQuery.MarketCode,\"-\",NativeQuery.EFSourceCodeName))","comparisonOperator":0,"fieldName":"SourceUniqueKey__c","logicalOperator":0,"id":"fb7bcaa4-7b89-4126-804b-ebe7695d7691"}],"fieldMappings":[{"id":"06661385-b067-453e-881f-812e5e46e078","targetDataType":"System.String","targetField":"Market__c","targetFormula":"IF(NativeQuery.IsStandardSourceCode=true,\"ALL\",NativeQuery.MarketCode)","path":"Source__c"},{"id":"484e8360-125d-485e-8d32-15fae0dda968","targetDataType":"System.String","targetField":"Code__c","targetFormula":"NativeQuery.EFSourceCodeName","path":"Source__c"},{"id":"c089d1f4-cde8-4750-a764-e98107015dfd","targetDataType":"System.Boolean","targetField":"IsGlobal__c","targetFormula":"IFNULLUSE(NativeQuery.IsStandardSourceCode,false)","path":"Source__c"},{"id":"9eeed90d-e905-4571-9bbd-4a5395d60916","targetDataType":"System.Boolean","targetField":"AvailableforManualEntry__c","targetFormula":"NativeQuery.ManualEntrySourceCode","path":"Source__c"},{"id":"c16b9088-532a-4944-a858-f10be581f617","targetDataType":"System.Boolean","targetField":"AvailableforExcelImport__c","targetFormula":"true","path":"Source__c"},{"id":"fa053879-405d-4c5b-b0e7-8acc2ab0b509","targetDataType":"System.Boolean","targetField":"IsActive__c","targetFormula":"IF(NativeQuery.SourceCodeStatusCode=\"AC\",true,false)","path":"Source__c"},{"id":"f66b0290-78eb-453c-840c-e42fd8534258","targetDataType":"System.String","targetField":"Name","targetFormula":"NativeQuery.SourceCodeDetailName","path":"Source__c"}]},{"id":"e2c08e57-5e33-4f77-851d-5e4c4a5b0bf5","blockType":"IfElse","category":"Control","name":"IfElse","description":"","label":"Update max TS processed","originalBlockLabel":"If","nextBlockId":"","parentBlockId":"","prevBlockId":"","x":597,"y":100,"firstChildBlockContainer1Id":"088174d8-a6dc-498b-87f0-7018449df11a","firstChildBlockContainer2Id":"","elseLabel":"else","expressionItems":[{"conditionOperator":0,"leftExpression":"RECNUM()","logicalOperator":0,"rightExpression":"1","id":"12eb85bc-7e19-4130-91c3-142ecbd7a130"}]},{"id":"088174d8-a6dc-498b-87f0-7018449df11a","blockType":"UpdateInsert","category":"Source","name":"SourceCode_ScribeTrackingUpdateInsert","description":"","label":"Update/Insert SourceCode_ScribeTracking","originalBlockLabel":"Update/Insert","nextBlockId":"","parentBlockId":"e2c08e57-5e33-4f77-851d-5e4c4a5b0bf5","prevBlockId":"","containerIndex":0,"entity":"SourceCode_ScribeTracking","actionName":"Update","connectionId":"bd24590d-4de3-4dc5-b564-12719dbde5e1","isOnNoMatchMessage":false,"isOnErrorMessage":true,"onErrorMessage":"Operation failed.  Label: [BLOCK LABEL], Name: [BLOCK NAME], Message: [ORIGINAL MESSAGE]","insertActionName":"Create","filterItems":[{"compareValue":"true","comparisonOperator":0,"fieldName":"IsScribeProcessed","logicalOperator":0,"id":"ed15641a-1b76-4c70-a052-6678e477ab9d"}],"fieldMappings":[{"id":"3c384349-d3b5-4bd9-bd33-013d525299f6","targetDataType":"System.Int32","targetField":"SourceCodeId","targetFormula":"NativeQuery.sourcecode_id","path":"SourceCode_ScribeTracking"},{"id":"18aea339-3aeb-4345-abed-48f07bc7a74f","targetDataType":"System.Byte[]","targetField":"SourceCodeTS","targetFormula":"NativeQuery.TS","path":"SourceCode_ScribeTracking"},{"id":"49825944-4f65-4d35-aa1f-7a4df118a6bb","targetDataType":"System.DateTime","targetField":"ScribeUTCDate","targetFormula":"GETUTCDATETIME()","path":"SourceCode_ScribeTracking"},{"id":"db4c43a2-271f-4fff-860a-ab461906bb70","targetDataType":"System.Boolean","targetField":"IsScribeProcessed","targetFormula":"true","path":"SourceCode_ScribeTracking"}]}],"Revision":9,"RevisionDate":"2018-06-14T08:43:18.853","RevisionComment":null}